\RequirePackage{plautopatch}  % pLaTeX または upLaTeX のとき
%\documentclass[uplatex,dvipdfmx,titlepage,a4j]{jsarticle}% upLaTeX のとき
\documentclass[dvipdfmx,titlepage,a4j]{jsarticle}  % pLaTeX のとき
\usepackage{listings,jvlisting}
\usepackage{amsmath,amssymb}
\usepackage{graphicx}
\usepackage[yen]{okuverb}
\usepackage{r04ec-exp}
\usepackage{here}
\usepackage{ascmac}
\usepackage{fancybox}
\usepackage{fancyvrb}
\usepackage{fancyhdr}
\usepackage{lastpage}
\usepackage{cases}

\fancypagestyle{foot}
{
\fancyhead[C]{数値シミュレーション}
\fancyhead[R]{42番 鷲尾 優作}
% \fancyfoot[C]{\thepage / \pageref{LastPage}}
\renewcommand\headrulewidth{0.4pt}
}

%ここからソースコードの表示に関する設定
\lstset{
  language={C++},
  basicstyle={\ttfamily},
  identifierstyle={\small},
  commentstyle={\smallitshape},
  keywordstyle={\small\bfseries},
  ndkeywordstyle={\small},
  stringstyle={\small\ttfamily},
  frame={tb},
  tabsize={2},
  breaklines=true,
  columns=[l]{fullflexible},
  numbers=left,
  xrightmargin=0zw,
  xleftmargin=3zw,
  numberstyle={\scriptsize},
  stepnumber=1,
  numbersep=1zw,
  lineskip=-0.5ex
}

\renewcommand{\lstlistingname}{リスト}
%ここまでソースコードの表示に関する設定

\title{数値シュミレーション}
% 学年・番号
\grade{4年42番}%
% 氏名
\author{鷲尾 優作}
% 班（後期は班に分かれて実験をする．そのときは，ここに班番号を記入する．）
\team{}
% 提出日
\date{2022年10月3日}
% 実験日
\expdate{2022年10月20日}
% 共同実験者
% グループに分かれて実験をするテーマでは，グループメンバーの番号名前を書く．
\coauthor{}
%
%記載例：
%\coauthor{%
%  2番 & 新潟　花子\\
%  11番 & 三条　次郎}
%%

\begin{document}
\pagestyle{foot}

\maketitle

\section{目的}
これまでの実験・講義では解析的に系の挙動を明らかにすることができるモデルを扱ってきた．

しかしながら，二重振り子をはじめとした複雑な系では従来の解析方法が適用できない場合が存在し，
この場合，エネルギ式を用いての運動方程式の導出や数値モデルを利用した運動シミュレーションが有効とされている．
同技術には，系の挙動の解析のみならず，安定化や安全性の向上に用いる制御器の制御パラメータの導出がコンピュータ上で行える利点がある．

ここでは，電気系・力学系のシミュレーションモデルをScilab上で構成し，解析結果の有効性確認方法・対象の制御パラメータの調整法を確認する．

\section{バネ-マス-ダンパ系のシミュレーション}
本来数値シミュレーションを必要とするのはより複雑な系の解析であるが，ここでは単純なバネ-マス-ダンパ系のシミュレーションモデルを
構成し，モデルの構成方法・出力の評価が正しく実施できることを確認する．

\paragraph{天井の固定点からバネ$k$[kg/s$^2$]でダンパ$c$[kg/s]で支持された質量$m$[kg]から
  なる系を考える．質量の運動は上下方向のみとし，重力と空気抵抗の影響は受けないものとする．
  この系に対し，ステップ状の外力$f(t) = f_o \cdot u(t)$ [kg $\cdot$ cm / s$^2$]
  が質量に加わった場合について調べる．}

\subsection{バネ-マス-ダンパ系の運動方程式の導出}
質量$m$の変位$x(t)$とすると，この物体の加速度は$\frac{d^2x(t)}{dt^2}$であるから，
運動の法則及び力の釣合より，運動方程式は(\ref{eq:bane-undou})式のように決定される．
\begin{eqnarray}
  m \frac{d^2x(t)}{dt^2} &=& f(t) - kx - c \frac{dx(t)}{dt} \nonumber \\
  &=& f_o \cdot u(t) - kx - c \frac{dx}{dt} \label{eq:bane-undou}
\end{eqnarray}

\subsection{構成したシミュレーションモデル}

(\ref{eq:bane-undou})式を解析し，変位$x(t)$[cm]及び速度$v(t)$[cm/s]を出力するシミュレーションモデルを構成する．

(\ref{eq:bane-undou})式の左辺が$x(t)$の2階微分項のみとなるよう変形した，(\ref{eq:bane-henkei})式を考える．
\begin{eqnarray}
  \frac{d^2x(t)}{dt^2} &=&  \frac{1}{m} f_o \cdot u(t) - \frac{k}{m} x - \frac{c}{m} \frac{dx(t)}{dt} \label{eq:bane-henkei}
\end{eqnarray}

$v(t) = \int \frac{d^2x(t)}{dt^2}$，$x(t) = \int v(t)$であるから，
(\ref{eq:bane-henkei})式を積分して速度$v(t)$[cm/s]が，更に再度積分して変位$x(t)$[cm]が求まる．
また，右辺に存在する定数$\frac{1}{m}$，$- \frac{k}{m}$，$- \frac{c}{m}$は$x(t)$に対して積の構造となっているため，線形なゲイン倍として表現できる．

これらの情報から，Scilabに用意されている積分器$\frac{1}{s}$及びゲイン倍ブロック用いれば，
ステップ入力に対してのモデルを構成できることがわかる．
作成したモデルを図\ref{fig:bane-model.png}に示す．

\begin{figure}[H]
  \centering
  \includegraphics[width=10cm]{../graph/bane-model.png}
  \caption{作成したシミュレーションモデル}
  \label{fig:bane-model.png}
\end{figure}

このとき，左側の積分器の出力が$v(t)$であり，右側の積分器の出力が$x(t)$である．

\subsection{シミュレーションパラメータ値の計算}
使用した各定数は参考文献[1]の指示に従い決定した．
実際に使用した値はそれぞれ次のとおりである．
\begin{itemize}
  \item $m = 出席番号 \times 100$ = 420[kg]
  \item $k = \frac{|150 + (出席番号 - 25)^2 \times 50|}{10} = 1460$[kg/s$^2$]
  \item $c = 650 - (出席番号 - 25)^2 = 361$[kg/s]
  \item $f_o = 300$[kg $\cdot$ cm / s$^2$]
\end{itemize}

\subsection{シミュレーション結果}
各定数を設定したモデルに対し，シミュレーション時間0[s]においてステップ入力1を与え，出力を得た．
変位$x(t)$[cm]及び速度$v(t)$[cm/s]の時間に対するグラフを図\ref{fig:bane-graph.png}に示す．

\begin{figure}[H]
  \centering
  \includegraphics[width=10cm]{../graph/bane-graph.png}
  \caption{系の時間応答シミュレーション結果}
  \label{fig:bane-graph.png}
\end{figure}

\subsection{シミュレーション結果の解析}
まず，質量は正のステップ入力に対し，$x(t)$が正の方向に変位し，また，加速により$v(t)$が正となることは間違いない．
少なくともこの観点には，図2の出力は沿った結果となっている．

次に，定常応答について評価する．
定常応答は，$t \rightarrow \infty$となったときの$x(t)$及び$v(t)$である．
質量は最終的に静止するはずであるから，$v(t)$の定常応答は0となるはずである．
一方，$x(t)$の定常応答は，バネによる弾性力とダンパによる抵抗力のバランスによって決定される．
$x(t)$の定常応答$x_\infty$は，$x_\infty = \frac{f_o}{k}$とすると，
$v(t)$が0となればダンパの抵抗力は発生しなくなることを考えれば，$x_\infty = \frac{300}{1460} = 0.205$[cm]となる．
これら2つの定常応答に対して，図2の出力は沿った結果となっている．

最終的にシミュレーションモデルの結果が正しいか判断するには，これに加え収束までの時間と，周波数について検討する必要があると考えられる．
しかし，今回は時間が足りなかったため，これらの検討は行わなかった．
したがってダンパ成分に対する評価が不十分である．

\section{天井クレーンの制御シミュレーション}
\subsection{天井クレーンの吊り荷部分の運動方程式の導出}
\subsection{シミュレーションパラメータの計算}
\subsection{設計仕様を満たすPID制御器の設計とシミュレーション結果}

\section{感想}

\begin{thebibliography}{99}
  \bibitem{ataka} 佐藤 拓史、実験テキスト「数値シュミレーション」、（2022年）,
\end{thebibliography}

\end{document}